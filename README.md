# üèõÔ∏è KazNU Lighthouse

> Telegram –±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ –∑–∞–Ω—è—Ç–∏–π –ö–∞–∑–∞—Ö—Å–∫–æ–≥–æ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.9+-blue.svg)](https://www.typescriptlang.org/)
[![Redis](https://img.shields.io/badge/Redis-7+-red.svg)](https://redis.io/)
[![Telegram Bot API](https://img.shields.io/badge/Telegram-Bot%20API-blue.svg)](https://core.telegram.org/bots/api)

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –¥–≤—É—Ö —É—á–µ–±–Ω—ã—Ö –≥—Ä—É–ø–ø —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –∫–æ–º–∞–Ω–¥—ã `/change`

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Node.js** 18 –∏–ª–∏ –≤—ã—à–µ
- **Redis** —Å–µ—Ä–≤–µ—Ä
- **Telegram Bot Token** (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/BotFather))

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/your-username/kaznu-lighthouse.git
cd kaznu-lighthouse
pnpm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:

```env
# Telegram Bot Token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
BOT_TOKEN=your_telegram_bot_token_here

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0
```

### 3. –ó–∞–ø—É—Å–∫ Redis

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# macOS
brew install redis
redis-server

# Ubuntu/Debian
sudo apt-get install redis-server
sudo systemctl start redis-server
```

### 4. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
pnpm build
pnpm start

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å Redis
pnpm start:full
```

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞   | –û–ø–∏—Å–∞–Ω–∏–µ                    |
| --------- | --------------------------- |
| `/change` | –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ |

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```mermaid
graph TB
    A[Telegram Bot] --> B[Notification Service]
    B --> C[Redis Queue - Bull]
    C --> D[Job Processor]

    E[Cron Jobs] --> B
    F[Schedule JSON Files] --> B
    G[User Repository] --> B

    subgraph "Cron Schedule"
        J["Daily: 07:00<br/>Morning notification"]
        K["Daily: 07:00<br/>Lesson reminders"]
    end

    E --> J
    E --> K
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### üîÑ Notification Service

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis Queue –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

#### üìä Redis Queue (Bull)

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ß–µ—Ä–µ–∑ Redis CLI

#### ‚è∞ Cron Jobs

- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**: 07:00 (Asia/Almaty) —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–Ω—è—Ç–∏–π
- **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–Ω—è—Ç–∏—è—Ö**: –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 07:00 –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è cron —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –≤–µ—Å—å –¥–µ–Ω—å
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∑–∞ —á–∞—Å –¥–æ –∑–∞–Ω—è—Ç–∏—è, –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–∫–∞

## üìÖ –§–æ—Ä–º–∞—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–µ –≥—Ä—É–ø–ø—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö `src/public/schedule_1.json` –∏ `src/public/schedule_2.json`. –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "saturday": [
    {
      "start_time": "09:00",
      "course": "–§–æ—Ä–º–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
      "room": "422 (–§–ò–¢)"
    },
    {
      "start_time": "10:00",
      "course": "–ê–ª–≥–æ—Ä–∏—Ç–º—ã",
      "room": "402 (–§–ò–¢)"
    }
  ]
}
```

### –ü—Ä–∞–≤–∏–ª–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ: `monday`, `tuesday`, `wednesday`, `thursday`, `friday`, `saturday`, `sunday`

## üí¨ –ü—Ä–∏–º–µ—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### –£—Ç—Ä–µ–Ω–Ω–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

```
–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ. –°–µ–≥–æ–¥–Ω—è 15 –¥–µ–∫–∞–±—Ä—è –∏ —É –Ω–∞—Å 4 –∑–∞–Ω—è—Ç–∏—è
```

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞–Ω—è—Ç–∏–∏

```
–£—Ä–æ–∫ –ê–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞—á–Ω–µ—Ç—Å—è —á–µ—Ä–µ–∑ —á–∞—Å –∏ –ø—Ä–æ–π–¥–µ—Ç –≤ 402 (–§–ò–¢)
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
pnpm dev

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Redis
pnpm redis          # –ó–∞–ø—É—Å–∫ Redis
pnpm redis:local    # –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ Redis

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
pnpm check:users    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
pnpm manage:users   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

# Redis CLI
pnpm redis:cli      # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
kaznu-lighthouse/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot.ts                    # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ redisConfig.ts        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notificationService.ts # –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user-repository.ts     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schedule_1.json        # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã 1
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schedule_2.json        # –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã 2
‚îÇ   ‚îî‚îÄ‚îÄ types.ts                   # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ check-users.js             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ manage-users.js            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ start-redis.sh             # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ Redis
‚îú‚îÄ‚îÄ redis.conf                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Redis
‚îî‚îÄ‚îÄ env.example                    # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Redis –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–§–∞–π–ª `redis.conf` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å: 256MB
- –ü–æ–ª–∏—Ç–∏–∫–∞ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è: allkeys-lru
- Persistence: RDB + AOF
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

### Redis –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **Redis**: –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä –æ—á–µ—Ä–µ–¥–µ–π
- **–õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫**: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç `scripts/start-redis.sh`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Redis CLI

–î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Redis CLI:

- –ö–æ–º–∞–Ω–¥–∞: `pnpm redis:cli`
- –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—á–µ—Ä–µ–¥–µ–π, –∫–ª—é—á–µ–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø—É
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É (`git checkout -b blablabla`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'feat:'`) (check https://www.conventionalcommits.org/en/v1.0.0/)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin blablabla`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request
